
using System.Configuration;


namespace Man_hours_managementApp
{

    internal static class Program　//同じプロジェクトならアクセス可
    {
        /// <summary>
        ///  The main entry point for the application.
        /// </summary>
        [STAThread] //Formを実行するMainでは必ず[STAThread]で指定
        static void Main()
        {
            // To customize application configuration such as set high DPI settings or default font,
            // see https://aka.ms/applicationconfiguration.
            ApplicationConfiguration.Initialize();　//アプリケーションの構成プロパティを初期化
            Application.Run(new LoginForm());
        }   
    }

    public class CommonUtil{
        public static string GetConnectionString() { 　//接続文字列を返すメソッド
            return ConfigurationManager.ConnectionStrings["sqlsvr"].ConnectionString;
        }
    }

    //入力チェッククラス
    static class InputCheck
    {
        //エラーフラグ
        static public bool isError { get; set; } = false;
        //エラー項目フォーカスセット
        static public bool onSetFocus { get; set; } = true;
        //エラー項目カラーセット
        static public bool onSetColor { get; set; } = true;
        //エラー項目にセットする背景色
        static private Color ErrorbackColor = Color.MistyRose;

        //文字区分
        public enum StrKind
        { 
            mix, //全角半角混在
            full, //全角のみ
            half //半角のみ
        };

        //文字列の入力チェック
        public static bool isString(ErrorProvider ep,
                            string itemName,
                            TextBox c,
                            bool required,
                            StrKind strKind = StrKind.mix)
        {
            backColorClear(c);
            string msg = "";

            if (String.IsNullOrEmpty(c.Text))
            {
                if(required)
                {
                    msg = $"[itemName]は必須項目です。";
                    errorSet(ep, c, msg);

                    return false;
                }
                else
                {
                    return true;
                }
            }
            return true;
        }
        //エラークリア処理
        public static void errorClear(ErrorProvider ep)
        {
            isError = false;
            ep.Clear();
        }
        //エラーメッセージの設定
        public static void errorSet(ErrorProvider ep, Control c, string msg)
        { 
            ep.SetError(c, msg);

            if (onSetFocus && isError == false)
            {
                c.Focus();    
            }

            if (onSetColor)
            {
                c.BackColor = ErrorbackColor;
            }

            isError = true;

        }
        //エラークリア処理
        public static void backColorClear(Control c)
        {
            if (onSetColor)
            {
                c.BackColor = Color.Empty;
            }
        }
    }

}